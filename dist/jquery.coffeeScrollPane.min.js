/*! coffeescrollpane 2013-07-28*/
/*! Version: 0.1.0 */
/*! License: BSD */
!function(){var CScrollPane,CScrollPaneApi,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};registerPlugin(settings)(function(){var settings;return settings=$.extend({},$.fn.cScrollPane.defaults,settings),$.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){return settings[this]=settings[this]||settings.speed}),this.each(function(){var cspApi,elem;return elem=$(this),cspApi=elem.data("csp"),cspApi?cspApi.reinitialise(settings):($("script",elem).filter('[type="text/javascript"],:not([type])').remove(),cspApi=new CScrollPane(elem,settings),elem.data("csp",cspApi))})}),CScrollPane=function(){function CScrollPane(){this.csp=this,this.wasAtTop=!0,this.wasAtLeft=!0,this.wasAtBottom=!1,this.wasAtRight=!1,this.originalElement=elem.clone(!1,!1).empty(),this.mwEvent=$.fn.mwheelIntent?"mwheelIntent.csp":"mousewheel.csp",this.originalPadding=""+elem.css("paddingTop")+" "+elem.css("paddingRight")+" "+elem.css("paddingBottom")+" "+elem.css("paddingLeft"),this.originalPaddingTotalWidth=(parseInt(elem.css("paddingLeft"),10)||0)+(parseInt(elem.css("paddingRight"),10)||0)}var defaults;return defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8},CScrollPane.prototype.initialise=function(s){var container,contentHeight,contentWidth,hasContainingSpaceChanged,isMaintainingPositon,isScrollableH,isScrollableV,lastContentX,lastContentY,maintainAtBottom,maintainAtRight,originalScrollLeft,originalScrollTop,pane,paneHeight,paneWidth,percentInViewH,percentInViewV,previousContentWidth,reinitialiseInterval,settings;if(maintainAtBottom=!1,maintainAtRight=!1,settings=s,"undefined"==typeof pane||null===pane)originalScrollTop=elem.scrollTop(),originalScrollLeft=elem.scrollLeft(),elem.css({overflow:"hidden",padding:0}),paneWidth=elem.innerWidth()+originalPaddingTotalWidth,paneHeight=elem.innerHeight(),elem.width(paneWidth),pane=$('<div class="cspPane" />').css("padding",originalPadding).append(elem.children()),container=$('<div class="cspContainer" />').css({width:paneWidth+"px",height:paneHeight+"px"}).append(pane).appendTo(elem);else{if(elem.css("width",""),maintainAtBottom=settings.stickToBottom&&isCloseToBottom(),maintainAtRight=settings.stickToRight&&isCloseToRight(),hasContainingSpaceChanged=elem.innerWidth()+originalPaddingTotalWidth!==paneWidth||elem.outerHeight()!==paneHeight,hasContainingSpaceChanged&&(paneWidth=elem.innerWidth()+originalPaddingTotalWidth,paneHeight=elem.innerHeight(),container.css({width:paneWidth+"px",height:paneHeight+"px"})),!hasContainingSpaceChanged&&previousContentWidth===contentWidth&&pane.outerHeight()===contentHeight)return elem.width(paneWidth),void 0;previousContentWidth=contentWidth,pane.css("width",""),elem.width(paneWidth),container.find(">.cspVerticalBar,>.cspHorizontalBar").remove().end()}return pane.css("overflow","auto"),contentWidth=s.contentWidth?s.contentWidth:pane[0].scrollWidth,contentHeight=pane[0].scrollHeight,pane.css("overflow",""),percentInViewH=contentWidth/paneWidth,percentInViewV=contentHeight/paneHeight,isScrollableV=percentInViewV>1,isScrollableH=percentInViewH>1,isScrollableH||isScrollableV?(elem.addClass("cspScrollable"),isMaintainingPositon=settings.maintainPosition&&(verticalDragPosition||horizontalDragPosition),isMaintainingPositon&&(lastContentX=contentPositionX(),lastContentY=contentPositionY()),initialiseVerticalScroll(),initialiseHorizontalScroll(),resizeScrollbars(),isMaintainingPositon&&(maintainAtRight?scrollToX(contentWidth-paneWidth,!1):scrollToX(lastContentX,!1),maintainAtBottom?scrollToY(contentHeight-paneHeight,!1):scrollToY(lastContentY,!1)),initFocusHandler(),initMousewheel(),initTouch(),settings.enableKeyboardNavigation&&initKeyboardNav(),settings.clickOnTrack&&initClickOnTrack(),observeHash(),settings.hijackInternalLinks&&hijackInternalLinks()):(elem.removeClass("cspScrollable"),pane.css({top:0,width:container.width()-originalPaddingTotalWidth}),removeMousewheel(),removeFocusHandler(),removeKeyboardNav(),removeClickOnTrack()),settings.autoReinitialise&&!reinitialiseInterval?reinitialiseInterval=setInterval(function(){return initialise(settings)},settings.autoReinitialiseDelay):!settings.autoReinitialise&&reinitialiseInterval&&clearInterval(reinitialiseInterval),originalScrollTop&&elem.scrollTop(0)&&scrollToY(originalScrollTop,!1),originalScrollLeft&&elem.scrollLeft(0)&&scrollToX(originalScrollLeft,!1),elem.trigger("csp-initialised",[isScrollableH||isScrollableV])},CScrollPane.prototype.initialiseVerticalScroll=function(){var arrowDown,arrowUp,verticalBar,verticalDrag,verticalTrack,verticalTrackHeight;return isScrollableV?(container.append($('<div class="cspVerticalBar" />').append($('<div class="cspCap cspCapTop" />'),$('<div class="cspTrack" />').append($('<div class="cspDrag" />').append($('<div class="cspDragTop" />'),$('<div class="cspDragBottom" />'))),$('<div class="cspCap cspCapBottom" />'))),verticalBar=container.find(">.cspVerticalBar"),verticalTrack=verticalBar.find(">.cspTrack"),verticalDrag=verticalTrack.find(">.cspDrag"),settings.showArrows&&(arrowUp=$('<a class="cspArrow cspArrowUp" />').bind("mousedown.csp",getArrowScroll(0,-1)).bind("click.csp",nil),arrowDown=$('<a class="cspArrow cspArrowDown" />').bind("mousedown.csp",getArrowScroll(0,1)).bind("click.csp",nil),settings.arrowScrollOnHover&&(arrowUp.bind("mouseover.csp",getArrowScroll(0,-1,arrowUp)),arrowDown.bind("mouseover.csp",getArrowScroll(0,1,arrowDown))),appendArrows(verticalTrack,settings.verticalArrowPositions,arrowUp,arrowDown)),verticalTrackHeight=paneHeight,container.find(">.cspVerticalBar>.cspCap:visible,>.cspVerticalBar>.cspArrow").each(function(){return verticalTrackHeight-=$(this).outerHeight()}),verticalDrag.hover(function(){return verticalDrag.addClass("cspHover")},function(){return verticalDrag.removeClass("cspHover")}).bind("mousedown.csp",function(e){var startY;return $("html").bind("dragstart.csp selectstart.csp",nil),verticalDrag.addClass("cspActive"),startY=e.pageY-verticalDrag.position().top,$("html").bind("mousemove.csp",function(e){return positionDragY(e.pageY-startY,!1)}).bind("mouseup.csp mouseleave.csp",cancelDrag),!1}),sizeVerticalScrollbar()):void 0},CScrollPane.prototype.sizeVerticalScrollbar=function(){var err,scrollbarWidth,verticalDragPosition;verticalTrack.height(verticalTrackHeight+"px"),verticalDragPosition=0,scrollbarWidth=settings.verticalGutter+verticalTrack.outerWidth(),pane.width(paneWidth-scrollbarWidth-originalPaddingTotalWidth);try{if(0===verticalBar.position().left)return pane.css("margin-left",scrollbarWidth+"px")}catch(_error){err=_error}},CScrollPane.prototype.initialiseHorizontalScroll=function(){var arrowLeft,arrowRight,horizontalBar,horizontalDrag,horizontalTrack,horizontalTrackWidth;return isScrollableH?(container.append($('<div class="cspHorizontalBar" />').append($('<div class="cspCap cspCapLeft" />'),$('<div class="cspTrack" />').append($('<div class="cspDrag" />').append($('<div class="cspDragLeft" />'),$('<div class="cspDragRight" />'))),$('<div class="cspCap cspCapRight" />'))),horizontalBar=container.find(">.cspHorizontalBar"),horizontalTrack=horizontalBar.find(">.cspTrack"),horizontalDrag=horizontalTrack.find(">.cspDrag"),settings.showArrows&&(arrowLeft=$('<a class="cspArrow cspArrowLeft" />').bind("mousedown.csp",getArrowScroll(-1,0)).bind("click.csp",nil),arrowRight=$('<a class="cspArrow cspArrowRight" />').bind("mousedown.csp",getArrowScroll(1,0)).bind("click.csp",nil),settings.arrowScrollOnHover&&(arrowLeft.bind("mouseover.csp",getArrowScroll(-1,0,arrowLeft)),arrowRight.bind("mouseover.csp",getArrowScroll(1,0,arrowRight))),appendArrows(horizontalTrack,settings.horizontalArrowPositions,arrowLeft,arrowRight)),horizontalDrag.hover(function(){return horizontalDrag.addClass("cspHover")},function(){return horizontalDrag.removeClass("cspHover")}).bind("mousedown.csp",function(e){var startX;return $("html").bind("dragstart.csp selectstart.csp",nil),horizontalDrag.addClass("cspActive"),startX=e.pageX-horizontalDrag.position().left,$("html").bind("mousemove.csp",function(e){return positionDragX(e.pageX-startX,!1)}).bind("mouseup.csp mouseleave.csp",cancelDrag),!1}),horizontalTrackWidth=container.innerWidth(),sizeHorizontalScrollbar()):void 0},CScrollPane.prototype.sizeHorizontalScrollbar=function(){var horizontalDragPosition;return container.find(">.cspHorizontalBar>.cspCap:visible,>.cspHorizontalBar>.cspArrow").each(function(){return horizontalTrackWidth-=$(this).outerWidth()}),horizontalTrack.width(horizontalTrackWidth+"px"),horizontalDragPosition=0},CScrollPane.prototype.resizeScrollbars=function(){var contentHeight,dragMaxX,dragMaxY,horizontalDragWidth,horizontalTrackHeight,percentInViewV,verticalDragHeight,verticalTrackWidth;return isScrollableH&&isScrollableV&&(horizontalTrackHeight=horizontalTrack.outerHeight(),verticalTrackWidth=verticalTrack.outerWidth(),verticalTrackHeight-=horizontalTrackHeight,$(horizontalBar).find(">.cspCap:visible,>.cspArrow").each(function(){return horizontalTrackWidth+=$(this).outerWidth()}),horizontalTrackWidth-=verticalTrackWidth,paneHeight-=verticalTrackWidth,paneWidth-=horizontalTrackHeight,horizontalTrack.parent().append($('<div class="cspCorner" />').css("width",horizontalTrackHeight+"px")),sizeVerticalScrollbar(),sizeHorizontalScrollbar()),isScrollableH&&pane.width(container.outerWidth()-originalPaddingTotalWidth+"px"),contentHeight=pane.outerHeight(),percentInViewV=contentHeight/paneHeight,isScrollableH&&(horizontalDragWidth=Math.ceil(1/percentInViewH*horizontalTrackWidth),horizontalDragWidth>settings.horizontalDragMaxWidth?horizontalDragWidth=settings.horizontalDragMaxWidth:horizontalDragWidth<settings.horizontalDragMinWidth&&(horizontalDragWidth=settings.horizontalDragMinWidth),horizontalDrag.width(horizontalDragWidth+"px"),dragMaxX=horizontalTrackWidth-horizontalDragWidth,_positionDragX(horizontalDragPosition)),isScrollableV?(verticalDragHeight=Math.ceil(1/percentInViewV*verticalTrackHeight),verticalDragHeight>settings.verticalDragMaxHeight?verticalDragHeight=settings.verticalDragMaxHeight:verticalDragHeight<settings.verticalDragMinHeight&&(verticalDragHeight=settings.verticalDragMinHeight),verticalDrag.height(verticalDragHeight+"px"),dragMaxY=verticalTrackHeight-verticalDragHeight,_positionDragY(verticalDragPosition)):void 0},CScrollPane.prototype.appendArrows=function(ele,p,a1,a2){var aTemp,p1,p2,_ref;return p1="before",p2="after","os"===p&&(p=null!=(_ref=/Mac/.test(navigator.platform))?_ref:{after:"split"}),p===p1?p2=p:p===p2&&(p1=p,aTemp=a1,a1=a2,a2=aTemp),ele[p1](a1)[p2](a2)},CScrollPane.prototype.getArrowScroll=function(dirX,dirY,ele){return function(){return arrowScroll(dirX,dirY,this,ele),this.blur(),!1}},CScrollPane.prototype.arrowScroll=function(dirX,dirY,arrow,ele){var doScroll,eve,isFirst;return arrow=$(arrow).addClass("cspActive"),isFirst=!0,doScroll=function(){var scrollTimeout;return 0!==dirX&&csp.scrollByX(dirX*settings.arrowButtonSpeed),0!==dirY&&csp.scrollByY(dirY*settings.arrowButtonSpeed),scrollTimeout=isFirst?setTimeout(doScroll,settings.initialDelay):setTimeout(doScroll,settings.arrowRepeatFreq),isFirst=!1},doScroll(),eve=ele?"mouseout.csp":"mouseup.csp",ele=ele||$("html"),ele.bind(eve,function(){var scrollTimeout;return arrow.removeClass("cspActive"),scrollTimeout&&clearTimeout(scrollTimeout),scrollTimeout=null,ele.unbind(eve)})},CScrollPane.prototype.initClickOnTrack=function(){return removeClickOnTrack(),isScrollableV&&verticalTrack.bind("mousedown.csp",function(e){var cancelClick,clickedTrack,direction,doScroll,isFirst,offset;return void 0===e.originalTarget||e.originalTarget===e.currentTarget?(clickedTrack=$(this),offset=clickedTrack.offset(),direction=e.pageY-offset.top-verticalDragPosition,isFirst=!0,doScroll=function(){var contentDragY,dragY,pos,scrollTimeout;if(offset=clickedTrack.offset(),pos=e.pageY-offset.top-verticalDragHeight/2,contentDragY=paneHeight*settings.scrollPagePercent,dragY=dragMaxY*contentDragY/(contentHeight-paneHeight),0>direction)verticalDragPosition-dragY>pos?csp.scrollByY(-contentDragY):positionDragY(pos);else{if(!(direction>0))return cancelClick(),void 0;pos>verticalDragPosition+dragY?csp.scrollByY(contentDragY):positionDragY(pos)}return scrollTimeout=isFirst?setTimeout(doScroll,settings.initialDelay):setTimeout(doScroll,settings.trackClickRepeatFreq),isFirst=!1},cancelClick=function(){var scrollTimeout;return scrollTimeout&&clearTimeout(scrollTimeout),scrollTimeout=null,$(document).unbind("mouseup.csp",cancelClick)},doScroll(),$(document).bind("mouseup.csp",cancelClick),!1):void 0}),isScrollableH?horizontalTrack.bind("mousedown.csp",function(e){var cancelClick,clickedTrack,direction,doScroll,isFirst,offset;return void 0===e.originalTarget||e.originalTarget===e.currentTarget?(clickedTrack=$(this),offset=clickedTrack.offset(),direction=e.pageX-offset.left-horizontalDragPosition,isFirst=!0,doScroll=function(){var contentDragX,dragX,pos,scrollTimeout;if(offset=clickedTrack.offset(),pos=e.pageX-offset.left-horizontalDragWidth/2,contentDragX=paneWidth*settings.scrollPagePercent,dragX=dragMaxX*contentDragX/(contentWidth-paneWidth),0>direction)horizontalDragPosition-dragX>pos?csp.scrollByX(-contentDragX):positionDragX(pos);else{if(!(direction>0))return cancelClick(),void 0;pos>horizontalDragPosition+dragX?csp.scrollByX(contentDragX):positionDragX(pos)}return scrollTimeout=isFirst?setTimeout(doScroll,settings.initialDelay):setTimeout(doScroll,settings.trackClickRepeatFreq),isFirst=!1},cancelClick=function(){var scrollTimeout;return scrollTimeout&&clearTimeout(scrollTimeout),scrollTimeout=null,$(document).unbind("mouseup.csp",cancelClick)},doScroll(),$(document).bind("mouseup.csp",cancelClick),!1):void 0}):void 0},CScrollPane.prototype.removeClickOnTrack=function(){return horizontalTrack&&horizontalTrack.unbind("mousedown.csp"),verticalTrack?verticalTrack.unbind("mousedown.csp"):void 0},CScrollPane.prototype.cancelDrag=function(){return $("html").unbind("dragstart.csp selectstart.csp mousemove.csp mouseup.csp mouseleave.csp"),verticalDrag&&verticalDrag.removeClass("cspActive"),horizontalDrag?horizontalDrag.removeClass("cspActive"):void 0},CScrollPane.prototype.positionDragY=function(destY,animate){return isScrollableV?(0>destY?destY=0:destY>dragMaxY&&(destY=dragMaxY),void 0===animate&&(animate=settings.animateScroll),animate?csp.animate(verticalDrag,"top",destY,_positionDragY):(verticalDrag.css("top",destY),_positionDragY(destY))):void 0},CScrollPane.prototype._positionDragY=function(destY){var destTop,isAtBottom,isAtTop,percentScrolled,verticalDragPosition,wasAtBottom,wasAtTop;return void 0===destY&&(destY=verticalDrag.position().top),container.scrollTop(0),verticalDragPosition=destY,isAtTop=0===verticalDragPosition,isAtBottom=verticalDragPosition===dragMaxY,percentScrolled=destY/dragMaxY,destTop=-percentScrolled*(contentHeight-paneHeight),(wasAtTop!==isAtTop||wasAtBottom!==isAtBottom)&&(wasAtTop=isAtTop,wasAtBottom=isAtBottom,elem.trigger("csp-arrow-change",[wasAtTop,wasAtBottom,wasAtLeft,wasAtRight])),updateVerticalArrows(isAtTop,isAtBottom),pane.css("top",destTop),elem.trigger("csp-scroll-y",[-destTop,isAtTop,isAtBottom]).trigger("scroll")},CScrollPane.prototype.positionDragX=function(destX,animate){return isScrollableH?(0>destX?destX=0:destX>dragMaxX&&(destX=dragMaxX),void 0===animate&&(animate=settings.animateScroll),animate?csp.animate(horizontalDrag,"left",destX,_positionDragX):(horizontalDrag.css("left",destX),_positionDragX(destX))):void 0},CScrollPane.prototype._positionDragX=function(destX){var destLeft,horizontalDragPosition,isAtLeft,isAtRight,percentScrolled,wasAtLeft,wasAtRight;return void 0===destX&&(destX=horizontalDrag.position().left),container.scrollTop(0),horizontalDragPosition=destX,isAtLeft=0===horizontalDragPosition,isAtRight=horizontalDragPosition===dragMaxX,percentScrolled=destX/dragMaxX,destLeft=-percentScrolled*(contentWidth-paneWidth),(wasAtLeft!==isAtLeft||wasAtRight!==isAtRight)&&(wasAtLeft=isAtLeft,wasAtRight=isAtRight,elem.trigger("csp-arrow-change",[wasAtTop,wasAtBottom,wasAtLeft,wasAtRight])),updateHorizontalArrows(isAtLeft,isAtRight),pane.css("left",destLeft),elem.trigger("csp-scroll-x",[-destLeft,isAtLeft,isAtRight]).trigger("scroll")},CScrollPane.prototype.updateVerticalArrows=function(isAtTop,isAtBottom){return settings.showArrows?(arrowUp[isAtTop?"addClass":"removeClass"]("cspDisabled"),arrowDown[isAtBottom?"addClass":"removeClass"]("cspDisabled")):void 0},CScrollPane.prototype.updateHorizontalArrows=function(isAtLeft,isAtRight){return settings.showArrows?(arrowLeft[isAtLeft?"addClass":"removeClass"]("cspDisabled"),arrowRight[isAtRight?"addClass":"removeClass"]("cspDisabled")):void 0},CScrollPane.prototype.scrollToY=function(destY,animate){var percentScrolled;return percentScrolled=destY/(contentHeight-paneHeight),positionDragY(percentScrolled*dragMaxY,animate)},CScrollPane.prototype.scrollToX=function(destX,animate){var percentScrolled;return percentScrolled=destX/(contentWidth-paneWidth),positionDragX(percentScrolled*dragMaxX,animate)},CScrollPane.prototype.scrollToElement=function(ele,stickToTop,animate){var destX,destY,e,eleHeight,eleLeft,eleTop,eleWidth,err,maxVisibleEleLeft,maxVisibleEleTop,viewportLeft,viewportTop;eleTop=0,eleLeft=0;try{e=$(ele)}catch(_error){return err=_error,void 0}for(eleHeight=e.outerHeight(),eleWidth=e.outerWidth(),container.scrollTop(0),container.scrollLeft(0);!e.is(".cspPane");)if(eleTop+=e.position().top,eleLeft+=e.position().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;return viewportTop=contentPositionY(),maxVisibleEleTop=viewportTop+paneHeight,viewportTop>eleTop||stickToTop?destY=eleTop-settings.verticalGutter:eleTop+eleHeight>maxVisibleEleTop&&(destY=eleTop-paneHeight+eleHeight+settings.verticalGutter),destY&&scrollToY(destY,animate),viewportLeft=contentPositionX(),maxVisibleEleLeft=viewportLeft+paneWidth,viewportLeft>eleLeft||stickToTop?destX=eleLeft-settings.horizontalGutter:eleLeft+eleWidth>maxVisibleEleLeft&&(destX=eleLeft-paneWidth+eleWidth+settings.horizontalGutter),destX?scrollToX(destX,animate):void 0},CScrollPane.prototype.contentPositionX=function(){return-pane.position().left},CScrollPane.prototype.contentPositionY=function(){return-pane.position().top},CScrollPane.prototype.isCloseToBottom=function(){var scrollableHeight;return scrollableHeight=contentHeight-paneHeight,scrollableHeight>20&&scrollableHeight-contentPositionY()<10},CScrollPane.prototype.isCloseToRight=function(){var scrollableWidth;return scrollableWidth=contentWidth-paneWidth,scrollableWidth>20&&scrollableWidth-contentPositionX()<10},CScrollPane.prototype.initMousewheel=function(){return container.unbind(mwEvent).bind(mwEvent,function(event,delta,deltaX,deltaY){var dX,dY;return dX=horizontalDragPosition,dY=verticalDragPosition,csp.scrollBy(deltaX*settings.mouseWheelSpeed,-deltaY*settings.mouseWheelSpeed,!1),dX===horizontalDragPosition&&dY===verticalDragPosition})},CScrollPane.prototype.removeMousewheel=function(){return container.unbind(mwEvent)},CScrollPane.prototype.nil=function(){return!1},CScrollPane.prototype.initFocusHandler=function(){return pane.find(":input,a").unbind("focus.csp").bind("focus.csp",function(e){return scrollToElement(e.target,!1)})},CScrollPane.prototype.removeFocusHandler=function(){return pane.find(":input,a").unbind("focus.csp")},CScrollPane.prototype.initKeyboardNav=function(){var validParents;return validParents=[],isScrollableH&&validParents.push(horizontalBar[0]),isScrollableV&&validParents.push(verticalBar[0]),pane.focus(function(){return elem.focus()}),elem.attr("tabindex",0).unbind("keydown.csp keypress.csp").bind("keydown.csp",function(e){var dX,dY,elementHasScrolled,keyDown;if(e.target===this||validParents.length&&$(e.target).closest(validParents).length){switch(dX=horizontalDragPosition,dY=verticalDragPosition,e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:keyDown=e.keyCode,keyDownHandler();break;case 35:scrollToY(contentHeight-paneHeight),keyDown=null;break;case 36:scrollToY(0),keyDown=null}return elementHasScrolled=e.keyCode===keyDown&&dX!==horizontalDragPosition||dY!==verticalDragPosition,!elementHasScrolled}}).bind("keypress.csp",function(e){return e.keyCode===keyDown&&keyDownHandler(),!elementHasScrolled}),settings.hideFocus?(elem.css("outline","none"),__indexOf.call(container[0],"hideFocus")>=0&&elem.attr("hideFocus",!0)):(elem.css("outline",""),__indexOf.call(container[0],"hideFocus")>=0&&elem.attr("hideFocus",!1)),{keyDownHandler:function(){var dX,dY,elementHasScrolled;switch(dX=horizontalDragPosition,dY=verticalDragPosition,keyDown){case 40:csp.scrollByY(settings.keyboardSpeed,!1);break;case 38:csp.scrollByY(-settings.keyboardSpeed,!1);break;case 34:case 32:csp.scrollByY(paneHeight*settings.scrollPagePercent,!1);break;case 33:csp.scrollByY(-paneHeight*settings.scrollPagePercent,!1);break;case 39:csp.scrollByX(settings.keyboardSpeed,!1);break;case 37:csp.scrollByX(-settings.keyboardSpeed,!1)}return elementHasScrolled=dX!==horizontalDragPosition||dY!==verticalDragPosition}}},CScrollPane.prototype.removeKeyboardNav=function(){return elem.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.csp keypress.csp")},CScrollPane.prototype.observeHash=function(){var e,err,hash,retryInt;if(location.hash&&location.hash.length>1){hash=escape(location.hash.substr(1));try{e=$("#"+hash+', a[name="'+hash+'"]')}catch(_error){return err=_error,void 0}if(e.length&&pane.find(hash))return 0===container.scrollTop()?retryInt=setInterval(function(){return container.scrollTop()>0?(scrollToElement(e,!0),$(document).scrollTop(container.position().top),clearInterval(retryInt)):void 0},50):(scrollToElement(e,!0),$(document).scrollTop(container.position().top))}},CScrollPane.prototype.hijackInternalLinks=function(){return $(document.body).data("cspHijack")?void 0:($(document.body).data("cspHijack",!0),$(document.body).delegate("a[href*=#]","click",function(event){var container,csp,e,element,elementTop,hash,href,locationHref,scrollTop;if(href=this.href.substr(0,this.href.indexOf("#")),locationHref=location.href,-1!==location.href.indexOf("#")&&(locationHref=location.href.substr(0,location.href.indexOf("#"))),href===locationHref){hash=escape(this.href.substr(this.href.indexOf("#")+1));try{element=$("#"+hash+', a[name="'+hash+'"]')}catch(_error){return e=_error,void 0}if(element.length)return container=element.closest(".cspScrollable"),csp=container.data("csp"),csp.scrollToElement(element,!0),container[0].scrollIntoView&&(scrollTop=$(window).scrollTop(),elementTop=element.offset().top,(scrollTop>elementTop||elementTop>scrollTop+$(window).height())&&container[0].scrollIntoView()),event.preventDefault()}}))},CScrollPane.prototype.initTouch=function(){var moving;return moving=!1,container.unbind("touchstart.csp touchmove.csp touchend.csp click.csp-touchclick").bind("touchstart.csp",function(e){var moved,startX,startY,touch,touchStartX,touchStartY;return touch=e.originalEvent.touches[0],startX=contentPositionX(),startY=contentPositionY(),touchStartX=touch.pageX,touchStartY=touch.pageY,moved=!1,moving=!0}).bind("touchmove.csp",function(ev){var dX,dY,moved,touchPos;if(moving)return touchPos=ev.originalEvent.touches[0],dX=horizontalDragPosition,dY=verticalDragPosition,csp.scrollTo(startX+touchStartX-touchPos.pageX,startY+touchStartY-touchPos.pageY),moved=moved||Math.abs(touchStartX-touchPos.pageX)>5||Math.abs(touchStartY-touchPos.pageY)>5,dX===horizontalDragPosition&&dY===verticalDragPosition}).bind("touchend.csp",function(){return moving=!1}).bind("click.csp-touchclick",function(){var moved;return moved?(moved=!1,!1):void 0})},CScrollPane.prototype.destroy=function(){var currentX,currentY;return currentY=contentPositionY(),currentX=contentPositionX(),elem.removeClass("cspScrollable").unbind(".csp"),elem.replaceWith(originalElement.append(pane.children())),originalElement.scrollTop(currentY),originalElement.scrollLeft(currentX),reinitialiseInterval?clearInterval(reinitialiseInterval):void 0},CScrollPane}(),CScrollPaneApi=function(){function CScrollPaneApi(){}return CScrollPaneApi.prototype.reinitialise=function(s){return s=$.extend({},settings,s),initialise(s)},CScrollPaneApi.prototype.scrollToElement=function(ele,stickToTop,animate){return scrollToElement(ele,stickToTop,animate)},CScrollPaneApi.prototype.scrollTo=function(destX,destY,animate){return scrollToX(destX,animate),scrollToY(destY,animate)},CScrollPaneApi.prototype.scrollToX=function(destX,animate){return scrollToX(destX,animate)},CScrollPaneApi.prototype.scrollToY=function(destY,animate){return scrollToY(destY,animate)},CScrollPaneApi.prototype.scrollToPercentX=function(destPercentX,animate){return scrollToX(destPercentX*(contentWidth-paneWidth),animate)},CScrollPaneApi.prototype.scrollToPercentY=function(destPercentY,animate){return scrollToY(destPercentY*(contentHeight-paneHeight),animate)},CScrollPaneApi.prototype.scrollBy=function(deltaX,deltaY,animate){return csp.scrollByX(deltaX,animate),csp.scrollByY(deltaY,animate)},CScrollPaneApi.prototype.scrollByX=function(deltaX,animate){var destX,percentScrolled,_ref;return destX=contentPositionX()+Math[null!=(_ref=0>deltaX)?_ref:{floor:"ceil"}](deltaX),percentScrolled=destX/(contentWidth-paneWidth),positionDragX(percentScrolled*dragMaxX,animate)},CScrollPaneApi.prototype.scrollByY=function(deltaY,animate){var destY,percentScrolled,_ref;return destY=contentPositionY()+Math[null!=(_ref=0>deltaY)?_ref:{floor:"ceil"}](deltaY),percentScrolled=destY/(contentHeight-paneHeight),positionDragY(percentScrolled*dragMaxY,animate)},CScrollPaneApi.prototype.positionDragX=function(x,animate){return positionDragX(x,animate)},CScrollPaneApi.prototype.positionDragY=function(y,animate){return positionDragY(y,animate)},CScrollPaneApi.prototype.animate=function(ele,prop,value,stepCallback){var params;return params={},params[prop]=value,ele.animate(params,{duration:settings.animateDuration,easing:settings.animateEase,queue:!1,step:stepCallback})},CScrollPaneApi.prototype.getContentPositionX=function(){return contentPositionX()},CScrollPaneApi.prototype.getContentPositionY=function(){return contentPositionY()},CScrollPaneApi.prototype.getContentWidth=function(){return contentWidth},CScrollPaneApi.prototype.getContentHeight=function(){return contentHeight},CScrollPaneApi.prototype.getPercentScrolledX=function(){return contentPositionX()/(contentWidth-paneWidth)},CScrollPaneApi.prototype.getPercentScrolledY=function(){return contentPositionY()/(contentHeight-paneHeight)},CScrollPaneApi.prototype.getIsScrollableH=function(){return isScrollableH},CScrollPaneApi.prototype.getIsScrollableV=function(){return isScrollableV},CScrollPaneApi.prototype.getContentPane=function(){return pane},CScrollPaneApi.prototype.scrollToBottom=function(animate){return positionDragY(dragMaxY,animate)},CScrollPaneApi.prototype.hijackInternalLinks=$.noop,CScrollPaneApi.prototype.destroy=function(){return destroy()},CScrollPaneApi}()}.call(this);